<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prontu√°rio Odontopedi√°trico</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="user-bar" class="user-bar">
        <div class="user-info" id="user-info-display" style="display: none;">
            <span>Ol√°, <strong id="display-nome-anotador">Estudante</strong> | </span>
            <a href="#" onclick="abrirPerfil()">Meu Perfil</a> | 
            <a href="#" onclick="fazerLogout()">Sair</a>
        </div>
        <div class="user-login" id="user-login-btn">
            <span>Voc√™ n√£o est√° identificado.</span>
            <button onclick="abrirModalLogin()" class="btn-small">Fazer Login</button>
        </div>
    </div>

    <div class="container">
        <h1>Prontu√°rio Odontopedi√°trico ü¶∑</h1>
        
        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
            <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQhltae5T3oMp-O4V0xqDAD7MHuGD96W3o0-1uKi4xLdm0lHg9k0y4vypvH0MqOAVugIQ9JTxPyrGbn/pubhtml?gid=720295404&single=true" target="_blank" class="sheet-button" style="flex: 1; background-color: #198754; border-color: #198754; color: white;">Planilha</a>
            <a href="relatorio.html" class="sheet-button" style="flex: 1; background-color: #6c757d; border-color: #6c757d; color: white;">Lista</a>
            <a href="dashboard.html" class="sheet-button" style="flex: 1; background-color: #17a2b8; border-color: #17a2b8; color: white;">Estat√≠sticas</a>
        </div>

        <form id="prontuario-form">
            
            <fieldset>
                <legend>Identifica√ß√£o da Equipe</legend>
                <div class="form-group">
                    <label for="anotador">Nome do Anotador (Voc√™):</label>
                    <input type="text" id="anotador" name="anotador" readonly style="background-color: #e9ecef; cursor: not-allowed;">
                </div>
                <div class="form-group">
                    <label for="examinador">Nome do Examinador:</label>
                    <input type="text" id="examinador" name="examinador" required>
                </div>
            </fieldset>

            <fieldset>
                <legend>Dados do Paciente</legend>
                <div class="form-group">
                    <label for="paciente">Nome do Paciente:</label>
                    <input type="text" id="paciente" name="paciente" required>
                </div>
                <div class="form-group">
                    <label for="sexo">Sexo:</label>
                    <select id="sexo" name="sexo" required style="width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #ccc;">
                        <option value="">Selecione...</option>
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="data-nascimento">Data de Nascimento:</label>
                    <input type="date" id="data-nascimento" name="data-nascimento" required>
                </div>
                <div class="form-group">
                    <label>Idade do Paciente:</label>
                    <span id="idade-calculada" style="font-weight:bold; color: #005a8d;">Preencha a data de nascimento</span>
                </div>
                <div class="form-group">
                    <label for="sala">Sala de Aula:</label>
                    <input type="text" id="sala" name="sala" placeholder="Ex: 3¬∫ Ano B" required>
                </div>
            </fieldset>

            <fieldset>
                <legend>Dados do Respons√°vel</legend>
                <div class="form-group">
                    <label for="responsavel">Nome do Respons√°vel:</label>
                    <input type="text" id="responsavel" name="responsavel" required>
                </div>
                <div class="form-group">
                    <label for="telefone">N√∫mero de Telefone:</label>
                    <input type="text" id="telefone" name="telefone" placeholder="(XX) XXXXX-XXXX" required>
                </div>
            </fieldset>

            <fieldset>
                <legend>Avalia√ß√£o Cl√≠nica</legend>
                
                <div class="form-group">
                    <label for="fluorose">Score de Fluorose (Dean):</label>
                    <select id="fluorose" name="fluorose" required style="width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #ccc; background-color: #fff;">
                        <option value="">Selecione o grau...</option>
                        <option value="0 - Normal">0 (Normal)</option>
                        <option value="1 - Question√°vel">1 (Question√°vel)</option>
                        <option value="2 - Muito Leve">2 (Muito Leve: <25%)</option>
                        <option value="3 - Leve">3 (Leve: <50%)</option>
                        <option value="4 - Moderada">4 (Moderada: >50%, √°reas de desgaste)</option>
                        <option value="5 - Severa">5 (Severa: grande √°rea de desgaste)</option>
                    </select>
                </div>

                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">

                <h3>Quais dentes o paciente possui?</h3>
                <div class="odontograma-container" id="secao-possui">
                    <div class="section-header">
                        <h4>Dentes Dec√≠duos</h4>
                        <div class="button-group">
                            <button type="button" id="fill-deciduos" class="action-button fill-all-button">Marcar Todos</button>
                            <button type="button" id="clear-deciduos" class="action-button clear-all-button">Desmarcar Todos</button>
                        </div>
                    </div>
                    <div class="dente-grid deciduo-grid" id="deciduos-r1"></div>
                    <div class="dente-grid deciduo-grid" id="deciduos-r2"></div>
                    <div class="dente-grid deciduo-grid" id="deciduos-r3"></div>
                    <div class="dente-grid deciduo-grid" id="deciduos-r4"></div>

                    <div class="section-header">
                        <h4>Dentes Permanentes</h4>
                        <div class="button-group">
                            <button type="button" id="fill-permanentes" class="action-button fill-all-button">Marcar Todos</button>
                            <button type="button" id="clear-permanentes" class="action-button clear-all-button">Desmarcar Todos</button>
                        </div>
                    </div>
                    <div class="dente-grid permanente-grid" id="permanentes-r1"></div>
                    <div class="dente-grid permanente-grid" id="permanentes-r2"></div>
                    <div class="dente-grid permanente-grid" id="permanentes-r3"></div>
                    <div class="dente-grid permanente-grid" id="permanentes-r4"></div>
                </div>

                <h3>Quais dentes est√£o h√≠gidos?</h3>
                <div class="section-header">
                    <span>Selecione os dentes h√≠gidos:</span>
                    <div class="button-group">
                        <button type="button" id="fill-higidos" class="action-button fill-all-button">Marcar Todos</button>
                        <button type="button" id="clear-higidos" class="action-button clear-all-button">Desmarcar Todos</button>
                    </div>
                </div>
                <div class="odontograma-container" id="secao-higidos">
                    <p>Selecione os dentes presentes primeiro.</p>
                </div>

                <h3>Quais dentes est√£o cariados?</h3>
                <div class="odontograma-container" id="secao-cariados">
                    <p>Selecione os dentes presentes e os h√≠gidos primeiro.</p>
                </div>

                <div id="container-faces-carie" style="display: none; margin-top: 20px; padding: 15px; background: #fff3cd; border: 1px solid #ffeeba; border-radius: 8px;">
                    <h4 style="color: #856404; margin-top: 0;">üìù Detalhes das C√°ries (Selecione as faces):</h4>
                    <div id="lista-faces-dinamica"></div>
                </div>

                <h3>Quais dentes est√£o obturados?</h3>
                <div class="odontograma-container" id="secao-obturados">
                    <div class="section-header">
                        <div class="button-group">
                            <button type="button" id="fill-obturados" class="action-button fill-all-button">Marcar Todos</button>
                            <button type="button" id="clear-obturados" class="action-button clear-all-button">Desmarcar Todos</button>
                        </div>
                    </div>
                </div>

                <h3>Quais dentes est√£o perdidos?</h3>
                <div class="odontograma-container" id="secao-perdidos">
                    <div class="section-header">
                        <div class="button-group">
                            <button type="button" id="fill-perdidos" class="action-button fill-all-button">Marcar Todos</button>
                            <button type="button" id="clear-perdidos" class="action-button clear-all-button">Desmarcar Todos</button>
                        </div>
                    </div>
                </div>

                <h3>Quais dentes indicados para extra√ß√£o?</h3>
                <div class="odontograma-container" id="secao-extracao">
                    <div class="section-header">
                        <div class="button-group">
                            <button type="button" id="fill-extracao" class="action-button fill-all-button">Marcar Todos</button>
                            <button type="button" id="clear-extracao" class="action-button clear-all-button">Desmarcar Todos</button>
                        </div>
                    </div>
                </div>

            </fieldset>

            <fieldset>
                <legend>Finaliza√ß√£o</legend>

                <div class="form-group">
                    <label for="observacoes">Observa√ß√µes:</label>
                    <textarea id="observacoes" name="observacoes" rows="4" style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ccc;" placeholder="Digite observa√ß√µes adicionais sobre o paciente..."></textarea>
                </div>

                <div class="form-group">
                    <label>Encaminhamento:</label>
                    <div class="radio-group" style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px;">
                        <div>
                            <input type="radio" id="enc-infantil" name="encaminhamento" value="Cl√≠nica Odontol√≥gica Integrada Infantil" required>
                            <label for="enc-infantil" style="font-weight: normal;">Cl√≠nica Odontol√≥gica Integrada Infantil</label>
                        </div>
                        <div>
                            <input type="radio" id="enc-integrada" name="encaminhamento" value="Cl√≠nica Odontol√≥gica Integrada">
                            <label for="enc-integrada" style="font-weight: normal;">Cl√≠nica Odontol√≥gica Integrada</label>
                        </div>
                        <div>
                            <input type="radio" id="enc-nao" name="encaminhamento" value="N√£o h√° necessidade de encaminhamento">
                            <label for="enc-nao" style="font-weight: normal;">N√£o h√° necessidade de encaminhamento</label>
                        </div>
                    </div>
                </div>

            </fieldset>
            
            <div id="bloqueio-envio" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 6px; text-align: center; display: none; margin-top: 20px;">
                <strong>üîí Login Necess√°rio</strong><br>
                Voc√™ precisa informar sua matr√≠cula para enviar o formul√°rio.
            </div>

            <button type="submit" id="submit-button">Salvar Prontu√°rio</button>
            <div id="loading-message" style="display: none;">Enviando dados...</div>
            <div id="success-message" style="display: none;">Dados salvos com sucesso!</div>
            <div id="error-message" style="display: none;">Ocorreu um erro. Tente novamente.</div>

        </form>
    </div>

    <div id="modal-login" class="modal-overlay" style="display: none;">
        <div class="modal-box">
            <h2>Identifica√ß√£o üéì</h2>
            <p>Digite sua matr√≠cula para acessar o sistema.</p>
            <input type="number" id="input-matricula" placeholder="Ex: 123456" style="margin-bottom: 10px; width: 100%; padding: 10px; box-sizing: border-box;">
            <p id="msg-erro-login" style="color: red; font-size: 0.9em; display: none; margin-bottom: 10px;"></p>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="fecharModal('modal-login')" class="btn-secundario">Cancelar</button>
                <button onclick="validarLogin()" class="btn-primario">Entrar</button>
            </div>
        </div>
    </div>

    <div id="modal-perfil" class="modal-overlay" style="display: none;">
        <div class="modal-box">
            <h2>Meu Perfil üë§</h2>
            <p>Configure suas prefer√™ncias.</p>
            
            <label style="display: block; margin-bottom: 5px;">Seu Nome (via Matr√≠cula):</label>
            <input type="text" id="perfil-nome" readonly style="background: #eee; margin-bottom: 15px; width: 100%;">
            
            <label style="display: block; margin-bottom: 5px;">Examinador Padr√£o:</label>
            <input type="text" id="perfil-examinador" placeholder="Ex: Prof. Silva" style="width: 100%;">
            <small style="color: #666; display: block; margin-bottom: 15px;">Este nome aparecer√° automaticamente no formul√°rio.</small>

            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="fecharModal('modal-perfil')" class="btn-secundario">Cancelar</button>
                <button onclick="salvarPerfil()" class="btn-primario">Salvar Prefer√™ncias</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>